<div class="container">
  <div style="text-align: center; margin: 3%">
    <h2>{{ edicion ? 'Editar Diario' : 'Registrar Diario' }}</h2>
  </div>
  <div style="text-align: center">
    <form [formGroup]="form" (submit)="aceptar()" class="example-form">
      @if (edicion) {
      <mat-form-field>
        <mat-label>Id</mat-label>
        <input matInput formControlName="id" required readonly />

        @if (form.get('id')?.hasError('required')) {
        <mat-error>El campo id es obligatorio.</mat-error>
        }
      </mat-form-field>
      }
      <br />
      <mat-form-field>
        <mat-label>Titulo</mat-label>
        <input matInput formControlName="titulo" required />

        @if (form.get('titulo')?.hasError('required')) {
        <mat-error>El campo titulo es obligatorio.</mat-error>
        }
      </mat-form-field>
      <br />
      <mat-form-field>
        <mat-label>Contenido</mat-label>
        <textarea
          matInput
          formControlName="contenido"
          required
          rows="4"
        ></textarea>

        @if (form.get('contenido')?.hasError('required')) {
        <mat-error>El campo contenido es obligatorio.</mat-error>
        }
      </mat-form-field>

      <br />
      <mat-form-field>
        <mat-label>Fecha</mat-label>
        <input
          matInput
          [matDatepicker]="picker"
          formControlName="fecha"
          [max]="today"
          required
        />
        <mat-hint>DD/MM/YYYY</mat-hint>
        <mat-datepicker-toggle
          matIconSuffix
          [for]="picker"
        ></mat-datepicker-toggle>
        <mat-datepicker #picker></mat-datepicker>

        @if (form.get('fecha')?.hasError('required')) {
        <mat-error>El campo fecha es obligatorio.</mat-error>
        }
      </mat-form-field>
      <br />
      <mat-form-field class="example-full-width">
        <mat-label>Usuario:</mat-label>
        <mat-select formControlName="usuarioFK" required>
          @for (p of listaUsuarios; track p.idUsuario) {
          <mat-option [value]="p.idUsuario"> {{ p.nombre }} </mat-option>
          }
        </mat-select>

        @if (form.get('usuario')?.hasError('required')) {
        <mat-error>El campo usuario es obligatorio.</mat-error>
        }
      </mat-form-field>

      <br />
      <mat-form-field class="example-full-width">
        <mat-label>Emoción:</mat-label>
        <mat-select formControlName="emocionesFK" required>
          @for (e of listaEmociones; track e.idEmociones) {
          <mat-option [value]="e.idEmociones"> {{ e.tipoEmocion }} </mat-option>
          }
        </mat-select>

        @if (form.get('emociones')?.hasError('required')) {
        <mat-error>El campo emoción es obligatorio.</mat-error>
        }
      </mat-form-field>

      <br />
      <button mat-raised-button color="primary" type="submit">
        {{ edicion ? 'Actualizar' : 'Registrar' }}
      </button>
      <button
        mat-button
        type="button"
        routerLink="/diario"
        style="margin-left: 10px"
      >
        Cancelar
      </button>
    </form>
  </div>
</div>
